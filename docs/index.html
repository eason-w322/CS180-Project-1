<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CS180 Project 1 · Colorizing the Prokudin-Gorskii Collection</title>
  <meta name="description" content="Project page for CS180/CS280A Project 1 with clean layout, sticky sidebar, results grid, and image-compare slider." />

  <!-- Single-file CSS (dark, clean, sticky sidebar) -->
  <style>
    :root{
      --bg:#0b0c10;--panel:#111318;--card:#151924;--border:#22283a;
      --text:#e8eef6;--muted:#a6b0c0;--accent:#57c7ff;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      background:linear-gradient(180deg,var(--bg),#0d1020 60%);
      color:var(--text);
      font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }

    /* Header */
    .site-header{padding:42px 20px 14px;text-align:center}
    .site-header h1{margin:0;font-size:2rem;letter-spacing:.2px}
    .subtitle{color:var(--muted);margin-top:.25rem}

    /* 2-col layout */
    .wrap{
      display:grid;grid-template-columns:260px 1fr;gap:20px;
      max-width:1120px;margin:0 auto;padding:20px;
    }

    /* Sidebar nav */
    .toc{
      position:sticky;top:20px;height:fit-content;
      background:var(--panel);border:1px solid var(--border);
      border-radius:14px;padding:16px;
    }
    .toc a{
      display:block;color:var(--text);text-decoration:none;
      padding:10px 12px;border-radius:10px;margin-bottom:6px;
      transition:background .2s,color .2s;
    }
    .toc a:hover{background:#1a1f2e;color:var(--accent)}
    .toc .mini{margin-top:10px;color:var(--muted);font-size:.9rem}

    /* Content cards */
    .content{display:grid;gap:20px}
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .card h2{margin:.2rem 0 1rem;font-size:1.25rem}

    code,kbd{background:#0f1423;border:1px solid #20263a;border-radius:6px;padding:.1rem .35rem}
    pre{background:#0f1423;border:1px solid #20263a;border-radius:8px;padding:12px;overflow:auto}
    .muted{color:var(--muted)}

    /* Compare slider */
    .compare{
      position:relative;width:100%;max-width:900px;aspect-ratio:3/2;
      border-radius:14px;overflow:hidden;border:1px solid var(--border);margin:4px 0 10px;
    }
    .compare .img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    .compare .before{clip-path:inset(0 50% 0 0);opacity:.9}
    .compare .slider{
      position:absolute;left:0;right:0;bottom:10px;margin:0 auto;width:min(420px,70%);
      -webkit-appearance:none;appearance:none;height:6px;background:#2a3146;border-radius:999px
    }
    .compare .slider::-webkit-slider-thumb{
      -webkit-appearance:none;appearance:none;width:22px;height:22px;border-radius:50%;
      background:var(--accent);border:2px solid #ffffff1a;box-shadow:0 2px 10px rgba(0,0,0,.35)
    }
    .caption{color:var(--muted);margin:.25rem 0 .2rem}

    /* Results grid */
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
    .tile{margin:0;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#0e1220}
    .tile img{display:block;width:100%;height:auto}
    figcaption{padding:10px 12px;border-top:1px solid var(--border)}
    .meta{color:var(--muted);font-size:.9rem;margin-top:2px}

    /* Footer */
    .site-footer{text-align:center;color:var(--muted);padding:26px 16px 44px}

    @media (max-width:900px){
      .wrap{grid-template-columns:1fr}
      .toc{position:static}
    }
  </style>
</head>
<body>
<header class="site-header">
  <h1>CS180 Project 1 — Colorizing Prokudin-Gorskii</h1>
  <p class="subtitle">Your Name · CS180/280A</p>
</header>

<main class="wrap">
  <!-- Sidebar -->
  <nav class="toc">
    <a href="#overview">Overview</a>
    <a href="#single">Single-Scale</a>
    <a href="#pyramid">Pyramid</a>
    <a href="#results">Results</a>
    <a href="#notes">Notes</a>
    <div class="mini">Tip: put images in <code>docs/results/</code></div>
  </nav>

  <!-- Main content -->
  <section class="content">

    <section id="overview" class="card">
      <h2>Overview</h2>
      <p>
        Each glass plate contains three grayscale exposures (top→bottom: B, G, R). I split the plate
        into thirds, align <strong>G</strong> and <strong>R</strong> to <strong>B</strong> using
        a small windowed search scored by <em>normalized cross-correlation</em> (ZNCC),
        then stack as RGB to form the color image.
      </p>
    </section>

    <section id="single" class="card">
      <h2>Single-Scale Alignment</h2>
      <ul>
        <li>Crop 10–15% borders to avoid black/white edges biasing the score.</li>
        <li>Exhaustive search over <code>dy, dx ∈ [−w, +w]</code> (e.g., <code>w=15</code>) with ZNCC.</li>
        <li>Shift with <code>np.roll</code>, stack <code>[R, G, B]</code>, clamp and save.</li>
      </ul>
      <pre><code># ZNCC (mean-zero) on the cropped interior
score = ((a-a.mean())*(b-b.mean())).sum() / ((a.std()*b.std())+1e-8)</code></pre>
    </section>

    <section id="pyramid" class="card">
      <h2>Coarse→Fine Pyramid</h2>
      <ol>
        <li>Downsample by 2 until min(H,W) is small (e.g., ≥200 px).</li>
        <li>Search at coarsest level (larger window OK).</li>
        <li>Upscale displacement; refine locally (±r) at each finer level.</li>
        <li>Optionally score on <em>gradient magnitude</em> for exposure-robust matches.</li>
      </ol>

      <!-- OPTIONAL before/after compare (replace images if you have a “before”) -->
      <div class="compare">
        <img class="img after"  src="results/emir_rgb.jpg"   alt="After (aligned RGB)">
        <img class="img before" src="results/emir_rgb.jpg"   alt="Before (placeholder)">
        <input class="slider" type="range" value="50" min="0" max="100" aria-label="Compare slider">
      </div>
      <p class="caption">Drag to compare (use your own misaligned “before” if desired).</p>
    </section>

    <section id="results" class="card">
      <h2>Results</h2>

      <!-- Results grid: replace filenames + fill in offsets -->
      <div class="grid">

        <figure class="tile">
          <img src="results/cathedral_rgb.jpg" alt="Cathedral (aligned)">
          <figcaption>
            <strong>Cathedral</strong>
            <div class="meta">G(dy,dx)=<code>(5, 2)</code>, R(dy,dx)=<code>(12, 3)</code></div>
          </figcaption>
        </figure>

        <figure class="tile">
          <img src="results/tobolsk_rgb.jpg" alt="Tobolsk (aligned)">
          <figcaption>
            <strong>Tobolsk</strong>
            <div class="meta">G(dy,dx)=<code>(3, 3)</code>, R(dy,dx)=<code>(6, 3)</code></div>
          </figcaption>
        </figure>

        <figure class="tile">
          <img src="results/emir_rgb.jpg" alt="Emir (aligned)">
          <figcaption>
            <strong>Emir</strong>
            <div class="meta">G(dy,dx)=<code>(49, 24)</code>, R(dy,dx)=<code>(107, 40)</code></div>
          </figcaption>
        </figure>

      </div>
    </section>

    <section id="notes" class="card">
      <h2>Notes / Bells & Whistles</h2>
      <ul>
        <li>Used gradient-magnitude ZNCC for tough cases (illumination changes).</li>
        <li>Trimmed 3% after stacking to hide colored borders from rolling.</li>
        <li>All processing in float, final save as 8-bit JPEG.</li>
      </ul>
    </section>

  </section>
</main>

<footer class="site-footer">
  <p>© 2025 Your Name · CS180/280A</p>
</footer>

<!-- Tiny JS for the compare slider -->
<script>
  document.querySelectorAll('.compare').forEach(cmp=>{
    const before = cmp.querySelector('.before');
    const slider = cmp.querySelector('.slider');
    if(!before||!slider) return;
    const set = v => before.style.clipPath = `inset(0 ${100-Number(v)}% 0 0)`;
    set(slider.value);
    slider.addEventListener('input', e => set(e.target.value));
  });
</script>
</body>
</html>
